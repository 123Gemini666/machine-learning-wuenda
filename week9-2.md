---
title: 吴恩达笔记10-推荐系统
top: false
cover: false
toc: true
mathjax: true
copyright: true
date: 2019-12-08 23:17:42
password:
summary:
tags:
  - 推荐系统
  - 协同过滤
categories:
  - Machine learning
  - 吴恩达
---

### 推荐系统 Recommender Systems

#### 推荐系统概述

常见的推荐系统有三种主要的应用常景

- 个性化推荐：常以“推荐”、“猜你喜欢”、“发现”等形式出现，一般放在首页位置
- 相关推荐：常以“相关推荐”、“看了还看”等形式出现，一般放在内容详情页
- 热门推荐：基于各种数据进行计算，得到的排行榜，支持全局排行以及分类排行等，位置不限

<!--MORE-->

推荐系统对用户的核心价值，主要表现在：

1. 帮助用户便捷、快速地筛选出感兴趣的内容
2. 在用户陌生的领域里面提供参考意见
3. 满足用户的好奇心

推荐系统的**主要工作**是：

- 首先它基于用户的兴趣，根据**用户的历史行为**做兴趣的挖掘，把物品和用户的**个性化偏好**进行匹配。
- 然后通过**推荐算法或者技术**把信息进行过滤，解决用户的**过载问题**。
- 当用户有**新的行为**发生时，比如点击或者搜索之后，能及时进一步**捕捉用户的兴趣**。
- 选择合适的场景，**个性化**或者相关的、热门的，来给用户进行推荐。

> 个性化推荐系统解决的是用户很内容的关联关系，它是二者之间的桥梁。基于用户的兴趣偏好，把用户感兴趣的物品或者视频、资讯等推荐给用户，给用户带来沉浸式的体验。

------

#### 问题形式化

> 推荐系统应用的十分广泛：如果你考虑网站像亚马逊，或网飞公司或易趣，或**iTunes Genius**，有很多的网站或系统试图推荐新产品给用户。如，亚马逊推荐新书给你，网飞公司试图推荐新电影给你，等等。这些推荐系统，根据浏览你过去买过什么书，或过去评价过什么电影来判断。这些系统会带来很大一部分收入，比如为亚马逊和像网飞这样的公司。因此，对推荐系统性能的改善，将对这些企业的有实质性和直接的影响。

**通过一个栗子来了解推荐系统**

假使我们是一个电影供应商，我们有 5 部电影和 4 个用户，我们要求用户为电影打分

![QaTZY4.png](https://s2.ax1x.com/2019/12/08/QaTZY4.png)

前三部是爱情片，后面两部是动作片。Alice和Bob更倾向于爱情片，Carol和Dave更倾向于动作片。一些标记

- $n_u$用户的数量
- $n_m$电影的数量
- $r(i,j)$如果用户j给电影i评过份则$r(i,j)=1$
- $y^{(i,j)}$代表的是用户j给电影i的评分
- $m_j$表示的是用户j评过分的电影总数

#### 基于内容的推荐系统Content Based Recommendations

在一个基于内容的推荐系统算法中，我们假设对于我们希望推荐的东西有一些数据，这些数据是有关这些东西的特征。现在假设电影有两个特征：

- $x_1$浪漫程度
- $x_2$动作程度

![Qa7nUS.png](https://s2.ax1x.com/2019/12/08/Qa7nUS.png)

那么每部电影都有一个特征向量，如第一部电影的是[0,9  0]

针对特征来构建一个推荐系统算法。假设使用的是线性回归模型，针对每个用户使用该模型，$\theta^{(1)}$表示的是第一个用户的模型的参数。定义如下：

- $\theta^{(j)}$第$j$个用户的参数向量
- $x^{(i)}$电影的$i$的特征向量

针对电影$i$和用户$j$，预测评分标准
$$
(\theta^{(j)})^Tx^{(i)}
$$
代价函数可以表示为（针对用户j）：**误差平方和+正则化项**
$$
\min_{\theta(j)}\frac{1}{2}\sum_{i:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)}) + \frac {\lambda}{2}(\theta^{(j)}_k)^2
$$
其中$i:r(i,j)$表示只计算用户$j$评过分的电影。**针对所有用户**的代价函数求和：
$$
\min_{\theta(1),...,\theta^{(n_u)}}\frac{1}{2}\sum^{n_u}_{j=1}\sum_{i:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)}) ^2+ \frac {\lambda}{2}\sum^{n_u}_{j=1}\sum^n_{k=1}(\theta^{(j)}_k)^2
$$
使用梯度下降法求出最优解，更新参数$\theta^{(j)}_{(k)}$
$$
\theta^{(j)}_{(k)} := \theta^{(j)}_{(k)} - \alpha\sum_{i:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)})x^{(i)}_k  ; k=0
$$

$$
\theta^{(j)}_{(k)} := \theta^{(j)}_{(k)} - \alpha(\sum_{i:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)})x^{(i)}_k+\lambda\theta^{(j)}_k)  ; k\neq0
$$

### 协同过滤Collaborative Filtering

上面基于内容的过滤算法是通过电影的特征，使用特征来训练出每个用户的参数。相反，如果使用用户的参数，也可以学习得出电影的特征：
$$
\min_{x(1),...,x^{(n_m)}}\frac{1}{2}\sum^{n_m}_{i=1}\sum_{j:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)}) ^2+ \frac {\lambda}{2}\sum^{n_m}_{i=1}\sum^n_{k=1}(x^{(j)}_k)^2
$$
如果没有用户的参数和电影的特征，协同过滤算法便可以同时学习这两者。
$$
J(x^{(1)},...x^{(n)},\theta^{(1),...,\theta^{(n_u)}}) = \frac{1}{2}\sum_{i,j:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)}) ^2+\frac {\lambda}{2}\sum^{n_m}_{i=1}\sum^n_{k=1}(x^{(j)}_k)^2+\frac {\lambda}{2}\sum^{n_u}_{j=1}\sum^n_{k=1}(\theta^{(j)}_k)^2
$$

对代价函数求出偏导数的结果是：
$$
x^{(j)}_{(k)} := x^{(j)}_{(k)} - \alpha(\sum_{j:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)})\theta^{(i)}_k+\lambda x^{(j)}_k)
$$

$$
\theta^{(j)}_{(k)} := \theta^{(j)}_{(k)} - \alpha(\sum_{i:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)})x^{(i)}_k+\lambda\theta^{(j)}_k)
$$

协同过滤算法的过程：

1. 初始化$x，\theta$为很小的值
2. 使用梯度下降算法最小化代价函数$\min J(x,\theta)$
3. 训练完算法后，预测用户j给电影i的评分

### 向量化：低秩矩阵分解Vectorization_ Low Rank Matrix Factorization

协同过滤算法可以做的事情：

1. 给出一件商品，找到与之类似的商品
2. 当一个用户浏览了一件产品，找出类似的商品推荐给他

假设5部电影，4位用户，存放在矩阵中：

| **Movie**            | **Alice (1)** | **Bob (2)** | **Carol (3)** | **Dave (4)** |
| :------------------- | :------------ | :---------- | :------------ | :----------- |
| Love at last         | 5             | 5           | 0             | 0            |
| Romance forever      | 5             | ?           | ?             | 0            |
| Cute puppies of love | ?             | 4           | 0             | ?            |
| Nonstop car chases   | 0             | 0           | 5             | 4            |
| Swords vs. karate    | 0             | 0           | 5             | ?            |

**推出相应的评分**

![](https://tva1.sinaimg.cn/large/006tNbRwly1g9po3rpe0yj30wc09a40t.jpg)

**找出类似的影片**

![](https://tva1.sinaimg.cn/large/006tNbRwly1g9po59jrltj30ys0fcq6c.jpg)

### 均值归一化Mean Normalization

![](https://tva1.sinaimg.cn/large/006tNbRwly1g9po8kgemmj30y007wdi6.jpg)

上图中，假设新来个用户Eva，他没有对任何的电影进行评分，那我们以什么依据来给他推荐电影呢？

- 对上面的Y矩阵进行均值归一化，将每个用户对某一部电影的评分减去所有用户对该电影评分的平均值，得到如下的矩阵：

![](https://tva1.sinaimg.cn/large/006tNbRwly1g9ppe9l6rkj30yg07wq5e.jpg)

- 利用新的矩阵Y来训练算法。如果我们要用新训练出的算法来预测评分，则需要将平均值重新加回去，预测$(\theta^{(j)}x^{(i)}+\mu_i$，模型会人为其给每部电影的评分都是该电影的平均分。
